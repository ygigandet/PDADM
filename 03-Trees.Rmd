## Trees

```{r}
set.seed(123) # for reproducibility
index.tr <- sample(x=1:nrow(GermanCredit), size=2/3*nrow(GermanCredit), replace=FALSE)
GermanCredit.tr <- GermanCredit[index.tr,]
GermanCredit.te <- GermanCredit[-index.tr,]
```

```{r, include=FALSE}
# Initialise our tree
GermanCreditTree <- rpart(as_factor(RESPONSE)~., data=GermanCredit.tr)
rpart.plot(GermanCreditTree)
```

```{r, include=FALSE}
plotcp(GermanCreditTree)
```

```{r, include=FALSE}
GermanCreditTree.prune <- prune(GermanCreditTree, cp=0.035)
rpart.plot(GermanCreditTree.prune)
```

```{r, include=FALSE}
pred <- predict(GermanCreditTree.prune, newdata=GermanCredit.te, type="class")
table(Pred=pred, Obs=GermanCredit.te$RESPONSE)

predict(GermanCreditTree.prune, newdata=GermanCredit.te, type="prob")
```



