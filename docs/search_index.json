[["index.html", "Project in Data Analytics for Decision Making Chapter 1 Introduction", " Project in Data Analytics for Decision Making Manon Verjus and Yooby Gigandet 2022-05-09 Chapter 1 Introduction Our work for the course “Project in Data Analytics for Decision Making” is to predict the credit risk associated to customers for our client, a bank. To do so, we used the CRISP-DM method (CRoss Industry Standard Process for Data Mining): Business understanding: Credit risk is defined as the risk of loss resulting from the failure by a borrower to repay the principal and interest owed to the lender. By performing a credit risk analysis, the lender determines the borrower’s ability to meet debt obligations in order to cushion itself from losses. It is therefore important to efficiently classify the risks of the credit applications. Data understanding and preparation: We work on the german dataset. Modelling: For this part, we used several models. Evaluation: Deployment: "],["data-understanding-and-preparation.html", "Chapter 2 Data understanding and preparation 2.1 Dataset 2.2 Exploratory Data Analysis", " Chapter 2 Data understanding and preparation 2.1 Dataset To create a model that will predict whether a client application represents a risk or not, we work on a dataset from our client containing data on 1000 past credit applications, described by the following variables: CHK_ACCT: The checking account status of the applicant in Deutsche Mark (DM). DURATION: The duration of the credit in months. HISTORY: The credit history of the applicant. NEW_CAR: Purpose of the credit. USED_CAR: Purpose of the credit. FURNITURE: Purpose of the credit. RADIO/TV: Purpose of the credit. EDUCATION: Purpose of the credit. RETRAINING: Purpose of the credit. AMOUNT: The credit amount. SAV_ACCT: The average balance in savings account in Deutsche Mark (DM). EMPLOYMENT: If the applicant is employed and since how long. INSTALL_RATE: The installment rate as percentage of disposable income. MALE_DIV: If the applicant is male and divorced. MALE_SINGLE: If the applicant is male and single. MALE_MAR_or_WID: If the applicant is male, married or widowed. CO_APPLICANT: If the applicant has a co-applicant. GUARANTOR: If the applicant has a guarantor. PRESENT_RESIDENT: If the applicant is a resident and since how many years. REAL_ESTATE: If the applicant owns real estate. PROP-UNKN-NONE: If the applicant owns no property (or unknown). AGE: Age of the applicant. OTHER_INSTALL: If the applicant has other installment plan credit. RENT: If the applicant rents. OWN_RES: If the applicant owns residence. NUM_CREDITS: Number of existing credits of the applicant at our client bank. JOB: The nature of the applicant’s job. NUM_DEPENDENT: Number of people for whom liable to provide maintenance. TELEPHONE: If the applicant has a phone in his or her name. FOREIGN: If the applicant is a foreign worker. RESPONSE: If the credit application is rated as “Good” or “Bad”. 2.2 Exploratory Data Analysis In this part, we thoroughly explore the dataset to get a better understanding. 2.2.1 Inacurracies By doing an exploratory data analysis, we find some inaccuracies and in agreement with our client, we change them as follow: One observation of the variable “AGE”: 75 instead of 125 years old. One observation of the variable “EDUCATION”: 1 instead of -1. One observation of the variable “GUARANTOR”: 1 instead of 2. Code the categories of the variable “PRESENT_RESID”: 0 to 3 instead of 1 to 4 2.2.2 Unbalanced observations One interesting point is that the dataset is heavily unbalanced: 700 credit applications rated as good versus 300 credit applications rated as bad. We will need to balance the dataset for our modelling. #&gt; $`1` #&gt; #&gt; $`2` #&gt; #&gt; attr(,&quot;class&quot;) #&gt; [1] &quot;list&quot; &quot;ggarrange&quot; The following plot shows a selection of the most important variables of our dataframe. The two main disadvantages of these methods are: The increasing overfitting risk when the number of observations is insufficient. The significant computation time when the number of variables is large. #&gt; Warning in train.default(x, y, weights = w, ...): You are trying to do regression and your outcome only has two #&gt; possible values Are you trying to do classification? If so, use a 2 level factor as your outcome column. #&gt; Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo, : There were missing values in #&gt; resampled performance measures. #&gt; rpart variable importance #&gt; #&gt; only 20 most important variables shown (out of 30) #&gt; #&gt; Overall #&gt; CHK_ACCT 0.1141 #&gt; DURATION 0.0803 #&gt; HISTORY 0.0767 #&gt; SAV_ACCT 0.0684 #&gt; AMOUNT 0.0516 #&gt; REAL_ESTATE 0.0343 #&gt; JOB 0.0000 #&gt; MALE_MAR_or_WID 0.0000 #&gt; PRESENT_RESIDENT 0.0000 #&gt; TELEPHONE 0.0000 #&gt; RETRAINING 0.0000 #&gt; USED_CAR 0.0000 #&gt; FURNITURE 0.0000 #&gt; AGE 0.0000 #&gt; OTHER_INSTALL 0.0000 #&gt; GUARANTOR 0.0000 #&gt; FOREIGN 0.0000 #&gt; RADIO_TV 0.0000 #&gt; OWN_RES 0.0000 #&gt; NEW_CAR 0.0000 "],["models.html", "Chapter 3 Models 3.1 Splitting strategies 3.2 Balance the dataset 3.3 Logistic Regression 3.4 Trees", " Chapter 3 Models After the exploration of our data, we start with the modelling part. 3.1 Splitting strategies In order to test the performance of our models, we use a splitting strategy of the dataset: 80% is used as a training set The remaining 20% is used as a test set. 3.2 Balance the dataset As said in the exploratory data analysis, we notice that our data is heavily unbalanced. We need to balance it before fitting our model. 3.3 Logistic Regression We fit a logistic regression to test if it could predict the output we desired. For our first model we’ll select all the variables given in the German Credit data set. #&gt; #&gt; Call: #&gt; glm(formula = as_factor(RESPONSE) ~ ., family = &quot;binomial&quot;, data = GermanCredit.tr.subs) #&gt; #&gt; Deviance Residuals: #&gt; Min 1Q Median 3Q Max #&gt; -2.2781 -0.7776 -0.0471 0.8323 2.6551 #&gt; #&gt; Coefficients: #&gt; Estimate Std. Error z value Pr(&gt;|z|) #&gt; (Intercept) 6.70e-03 1.22e+00 0.01 0.9956 #&gt; CHK_ACCT 6.03e-01 1.03e-01 5.86 4.7e-09 *** #&gt; DURATION -2.43e-02 1.27e-02 -1.92 0.0552 . #&gt; HISTORY 4.00e-01 1.25e-01 3.19 0.0014 ** #&gt; NEW_CAR -5.80e-01 5.18e-01 -1.12 0.2624 #&gt; USED_CAR 1.10e+00 6.75e-01 1.62 0.1042 #&gt; FURNITURE -1.79e-02 5.42e-01 -0.03 0.9737 #&gt; RADIO_TV -2.47e-01 5.22e-01 -0.47 0.6358 #&gt; EDUCATION -8.22e-01 7.21e-01 -1.14 0.2540 #&gt; RETRAINING -8.61e-03 6.14e-01 -0.01 0.9888 #&gt; AMOUNT -1.35e-04 6.31e-05 -2.14 0.0323 * #&gt; SAV_ACCT 1.86e-01 7.91e-02 2.35 0.0188 * #&gt; EMPLOYMENT 1.59e-01 1.09e-01 1.45 0.1473 #&gt; INSTALL_RATE -3.65e-01 1.21e-01 -3.00 0.0027 ** #&gt; MALE_DIV 3.84e-02 5.32e-01 0.07 0.9424 #&gt; MALE_SINGLE 6.55e-01 2.82e-01 2.32 0.0201 * #&gt; MALE_MAR_or_WID 1.91e-01 4.32e-01 0.44 0.6583 #&gt; CO_APPLICANT -8.07e-01 5.92e-01 -1.36 0.1730 #&gt; GUARANTOR 8.96e-01 5.31e-01 1.69 0.0912 . #&gt; PRESENT_RESIDENT 1.10e-02 1.21e-01 0.09 0.9281 #&gt; REAL_ESTATE 4.00e-01 2.83e-01 1.41 0.1574 #&gt; PROP_UNKN_NONE -9.33e-03 5.25e-01 -0.02 0.9858 #&gt; AGE 1.24e-02 1.28e-02 0.96 0.3354 #&gt; OTHER_INSTALL -6.81e-01 2.97e-01 -2.30 0.0216 * #&gt; RENT -5.14e-02 6.47e-01 -0.08 0.9367 #&gt; OWN_RES 3.42e-01 6.27e-01 0.54 0.5860 #&gt; NUM_CREDITS -4.61e-01 2.31e-01 -2.00 0.0457 * #&gt; JOB 2.55e-02 1.94e-01 0.13 0.8952 #&gt; NUM_DEPENDENTS -5.21e-01 3.45e-01 -1.51 0.1311 #&gt; TELEPHONE 1.94e-01 2.61e-01 0.74 0.4581 #&gt; FOREIGN 1.09e+00 7.31e-01 1.50 0.1345 #&gt; --- #&gt; Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 #&gt; #&gt; (Dispersion parameter for binomial family taken to be 1) #&gt; #&gt; Null deviance: 654.33 on 471 degrees of freedom #&gt; Residual deviance: 477.83 on 441 degrees of freedom #&gt; AIC: 539.8 #&gt; #&gt; Number of Fisher Scoring iterations: 5 Our initial model is therefore: \\[ z_i = a_o + a_1CHKACCT_{1i} + ... + a_{32}Foreign_{1i} \\] Let’s check if we can select better variables for the model #&gt; Start: AIC=540 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + FURNITURE + RADIO_TV + EDUCATION + RETRAINING + #&gt; AMOUNT + SAV_ACCT + EMPLOYMENT + INSTALL_RATE + MALE_DIV + #&gt; MALE_SINGLE + MALE_MAR_or_WID + CO_APPLICANT + GUARANTOR + #&gt; PRESENT_RESIDENT + REAL_ESTATE + PROP_UNKN_NONE + AGE + OTHER_INSTALL + #&gt; RENT + OWN_RES + NUM_CREDITS + JOB + NUM_DEPENDENTS + TELEPHONE + #&gt; FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - RETRAINING 1 478 538 #&gt; - PROP_UNKN_NONE 1 478 538 #&gt; - FURNITURE 1 478 538 #&gt; - MALE_DIV 1 478 538 #&gt; - RENT 1 478 538 #&gt; - PRESENT_RESIDENT 1 478 538 #&gt; - JOB 1 478 538 #&gt; - MALE_MAR_or_WID 1 478 538 #&gt; - RADIO_TV 1 478 538 #&gt; - OWN_RES 1 478 538 #&gt; - TELEPHONE 1 478 538 #&gt; - AGE 1 479 539 #&gt; - NEW_CAR 1 479 539 #&gt; - EDUCATION 1 479 539 #&gt; - CO_APPLICANT 1 480 540 #&gt; &lt;none&gt; 478 540 #&gt; - REAL_ESTATE 1 480 540 #&gt; - EMPLOYMENT 1 480 540 #&gt; - NUM_DEPENDENTS 1 480 540 #&gt; - FOREIGN 1 480 540 #&gt; - USED_CAR 1 481 541 #&gt; - GUARANTOR 1 481 541 #&gt; - DURATION 1 482 542 #&gt; - NUM_CREDITS 1 482 542 #&gt; - AMOUNT 1 483 543 #&gt; - OTHER_INSTALL 1 483 543 #&gt; - MALE_SINGLE 1 483 543 #&gt; - SAV_ACCT 1 483 543 #&gt; - INSTALL_RATE 1 487 547 #&gt; - HISTORY 1 489 549 #&gt; - CHK_ACCT 1 515 575 #&gt; #&gt; Step: AIC=538 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + FURNITURE + RADIO_TV + EDUCATION + AMOUNT + SAV_ACCT + #&gt; EMPLOYMENT + INSTALL_RATE + MALE_DIV + MALE_SINGLE + MALE_MAR_or_WID + #&gt; CO_APPLICANT + GUARANTOR + PRESENT_RESIDENT + REAL_ESTATE + #&gt; PROP_UNKN_NONE + AGE + OTHER_INSTALL + RENT + OWN_RES + NUM_CREDITS + #&gt; JOB + NUM_DEPENDENTS + TELEPHONE + FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - PROP_UNKN_NONE 1 478 536 #&gt; - FURNITURE 1 478 536 #&gt; - MALE_DIV 1 478 536 #&gt; - RENT 1 478 536 #&gt; - PRESENT_RESIDENT 1 478 536 #&gt; - JOB 1 478 536 #&gt; - MALE_MAR_or_WID 1 478 536 #&gt; - OWN_RES 1 478 536 #&gt; - RADIO_TV 1 478 536 #&gt; - TELEPHONE 1 478 536 #&gt; - AGE 1 479 537 #&gt; - EDUCATION 1 480 538 #&gt; - CO_APPLICANT 1 480 538 #&gt; &lt;none&gt; 478 538 #&gt; - REAL_ESTATE 1 480 538 #&gt; - EMPLOYMENT 1 480 538 #&gt; - NEW_CAR 1 480 538 #&gt; - NUM_DEPENDENTS 1 480 538 #&gt; - FOREIGN 1 480 538 #&gt; - GUARANTOR 1 481 539 #&gt; - USED_CAR 1 482 540 #&gt; - DURATION 1 482 540 #&gt; - NUM_CREDITS 1 482 540 #&gt; - AMOUNT 1 483 541 #&gt; - OTHER_INSTALL 1 483 541 #&gt; - MALE_SINGLE 1 483 541 #&gt; - SAV_ACCT 1 483 541 #&gt; - INSTALL_RATE 1 487 545 #&gt; - HISTORY 1 489 547 #&gt; - CHK_ACCT 1 515 573 #&gt; #&gt; Step: AIC=536 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + FURNITURE + RADIO_TV + EDUCATION + AMOUNT + SAV_ACCT + #&gt; EMPLOYMENT + INSTALL_RATE + MALE_DIV + MALE_SINGLE + MALE_MAR_or_WID + #&gt; CO_APPLICANT + GUARANTOR + PRESENT_RESIDENT + REAL_ESTATE + #&gt; AGE + OTHER_INSTALL + RENT + OWN_RES + NUM_CREDITS + JOB + #&gt; NUM_DEPENDENTS + TELEPHONE + FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - FURNITURE 1 478 534 #&gt; - MALE_DIV 1 478 534 #&gt; - RENT 1 478 534 #&gt; - PRESENT_RESIDENT 1 478 534 #&gt; - JOB 1 478 534 #&gt; - MALE_MAR_or_WID 1 478 534 #&gt; - RADIO_TV 1 478 534 #&gt; - TELEPHONE 1 478 534 #&gt; - OWN_RES 1 478 534 #&gt; - AGE 1 479 535 #&gt; - EDUCATION 1 480 536 #&gt; &lt;none&gt; 478 536 #&gt; - CO_APPLICANT 1 480 536 #&gt; - REAL_ESTATE 1 480 536 #&gt; - EMPLOYMENT 1 480 536 #&gt; - NEW_CAR 1 480 536 #&gt; - NUM_DEPENDENTS 1 480 536 #&gt; - FOREIGN 1 480 536 #&gt; - GUARANTOR 1 481 537 #&gt; - USED_CAR 1 482 538 #&gt; - DURATION 1 482 538 #&gt; - NUM_CREDITS 1 482 538 #&gt; - AMOUNT 1 483 539 #&gt; - MALE_SINGLE 1 483 539 #&gt; - OTHER_INSTALL 1 483 539 #&gt; - SAV_ACCT 1 483 539 #&gt; - INSTALL_RATE 1 487 543 #&gt; - HISTORY 1 489 545 #&gt; - CHK_ACCT 1 515 571 #&gt; #&gt; Step: AIC=534 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + RADIO_TV + EDUCATION + AMOUNT + SAV_ACCT + EMPLOYMENT + #&gt; INSTALL_RATE + MALE_DIV + MALE_SINGLE + MALE_MAR_or_WID + #&gt; CO_APPLICANT + GUARANTOR + PRESENT_RESIDENT + REAL_ESTATE + #&gt; AGE + OTHER_INSTALL + RENT + OWN_RES + NUM_CREDITS + JOB + #&gt; NUM_DEPENDENTS + TELEPHONE + FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - MALE_DIV 1 478 532 #&gt; - RENT 1 478 532 #&gt; - PRESENT_RESIDENT 1 478 532 #&gt; - JOB 1 478 532 #&gt; - MALE_MAR_or_WID 1 478 532 #&gt; - TELEPHONE 1 478 532 #&gt; - OWN_RES 1 478 532 #&gt; - RADIO_TV 1 478 532 #&gt; - AGE 1 479 533 #&gt; - EDUCATION 1 480 534 #&gt; &lt;none&gt; 478 534 #&gt; - CO_APPLICANT 1 480 534 #&gt; - REAL_ESTATE 1 480 534 #&gt; - EMPLOYMENT 1 480 534 #&gt; - NUM_DEPENDENTS 1 480 534 #&gt; - FOREIGN 1 480 534 #&gt; - GUARANTOR 1 481 535 #&gt; - NEW_CAR 1 481 535 #&gt; - DURATION 1 482 536 #&gt; - NUM_CREDITS 1 482 536 #&gt; - USED_CAR 1 482 536 #&gt; - AMOUNT 1 483 537 #&gt; - MALE_SINGLE 1 483 537 #&gt; - OTHER_INSTALL 1 483 537 #&gt; - SAV_ACCT 1 483 537 #&gt; - INSTALL_RATE 1 487 541 #&gt; - HISTORY 1 489 543 #&gt; - CHK_ACCT 1 516 570 #&gt; #&gt; Step: AIC=532 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + RADIO_TV + EDUCATION + AMOUNT + SAV_ACCT + EMPLOYMENT + #&gt; INSTALL_RATE + MALE_SINGLE + MALE_MAR_or_WID + CO_APPLICANT + #&gt; GUARANTOR + PRESENT_RESIDENT + REAL_ESTATE + AGE + OTHER_INSTALL + #&gt; RENT + OWN_RES + NUM_CREDITS + JOB + NUM_DEPENDENTS + TELEPHONE + #&gt; FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - PRESENT_RESIDENT 1 478 530 #&gt; - RENT 1 478 530 #&gt; - JOB 1 478 530 #&gt; - MALE_MAR_or_WID 1 478 530 #&gt; - TELEPHONE 1 478 530 #&gt; - OWN_RES 1 478 530 #&gt; - RADIO_TV 1 478 530 #&gt; - AGE 1 479 531 #&gt; &lt;none&gt; 478 532 #&gt; - EDUCATION 1 480 532 #&gt; - CO_APPLICANT 1 480 532 #&gt; - REAL_ESTATE 1 480 532 #&gt; - EMPLOYMENT 1 480 532 #&gt; - NUM_DEPENDENTS 1 480 532 #&gt; - FOREIGN 1 480 532 #&gt; - GUARANTOR 1 481 533 #&gt; - NEW_CAR 1 482 534 #&gt; - DURATION 1 482 534 #&gt; - NUM_CREDITS 1 482 534 #&gt; - USED_CAR 1 483 535 #&gt; - AMOUNT 1 483 535 #&gt; - OTHER_INSTALL 1 483 535 #&gt; - SAV_ACCT 1 483 535 #&gt; - MALE_SINGLE 1 484 536 #&gt; - INSTALL_RATE 1 487 539 #&gt; - HISTORY 1 489 541 #&gt; - CHK_ACCT 1 516 568 #&gt; #&gt; Step: AIC=530 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + RADIO_TV + EDUCATION + AMOUNT + SAV_ACCT + EMPLOYMENT + #&gt; INSTALL_RATE + MALE_SINGLE + MALE_MAR_or_WID + CO_APPLICANT + #&gt; GUARANTOR + REAL_ESTATE + AGE + OTHER_INSTALL + RENT + OWN_RES + #&gt; NUM_CREDITS + JOB + NUM_DEPENDENTS + TELEPHONE + FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - RENT 1 478 528 #&gt; - JOB 1 478 528 #&gt; - MALE_MAR_or_WID 1 478 528 #&gt; - TELEPHONE 1 478 528 #&gt; - OWN_RES 1 478 528 #&gt; - RADIO_TV 1 478 528 #&gt; - AGE 1 479 529 #&gt; &lt;none&gt; 478 530 #&gt; - EDUCATION 1 480 530 #&gt; - CO_APPLICANT 1 480 530 #&gt; - REAL_ESTATE 1 480 530 #&gt; - EMPLOYMENT 1 480 530 #&gt; - NUM_DEPENDENTS 1 480 530 #&gt; - FOREIGN 1 480 530 #&gt; - GUARANTOR 1 481 531 #&gt; - NEW_CAR 1 482 532 #&gt; - DURATION 1 482 532 #&gt; - NUM_CREDITS 1 482 532 #&gt; - USED_CAR 1 483 533 #&gt; - AMOUNT 1 483 533 #&gt; - OTHER_INSTALL 1 483 533 #&gt; - SAV_ACCT 1 484 534 #&gt; - MALE_SINGLE 1 484 534 #&gt; - INSTALL_RATE 1 487 537 #&gt; - HISTORY 1 489 539 #&gt; - CHK_ACCT 1 517 567 #&gt; #&gt; Step: AIC=528 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + RADIO_TV + EDUCATION + AMOUNT + SAV_ACCT + EMPLOYMENT + #&gt; INSTALL_RATE + MALE_SINGLE + MALE_MAR_or_WID + CO_APPLICANT + #&gt; GUARANTOR + REAL_ESTATE + AGE + OTHER_INSTALL + OWN_RES + #&gt; NUM_CREDITS + JOB + NUM_DEPENDENTS + TELEPHONE + FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - JOB 1 478 526 #&gt; - MALE_MAR_or_WID 1 478 526 #&gt; - TELEPHONE 1 478 526 #&gt; - RADIO_TV 1 478 526 #&gt; - AGE 1 479 527 #&gt; &lt;none&gt; 478 528 #&gt; - EDUCATION 1 480 528 #&gt; - REAL_ESTATE 1 480 528 #&gt; - CO_APPLICANT 1 480 528 #&gt; - OWN_RES 1 480 528 #&gt; - EMPLOYMENT 1 480 528 #&gt; - NUM_DEPENDENTS 1 480 528 #&gt; - FOREIGN 1 480 528 #&gt; - GUARANTOR 1 481 529 #&gt; - NEW_CAR 1 482 530 #&gt; - DURATION 1 482 530 #&gt; - NUM_CREDITS 1 482 530 #&gt; - USED_CAR 1 483 531 #&gt; - AMOUNT 1 483 531 #&gt; - OTHER_INSTALL 1 483 531 #&gt; - SAV_ACCT 1 484 532 #&gt; - MALE_SINGLE 1 484 532 #&gt; - INSTALL_RATE 1 487 535 #&gt; - HISTORY 1 489 537 #&gt; - CHK_ACCT 1 517 565 #&gt; #&gt; Step: AIC=526 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + RADIO_TV + EDUCATION + AMOUNT + SAV_ACCT + EMPLOYMENT + #&gt; INSTALL_RATE + MALE_SINGLE + MALE_MAR_or_WID + CO_APPLICANT + #&gt; GUARANTOR + REAL_ESTATE + AGE + OTHER_INSTALL + OWN_RES + #&gt; NUM_CREDITS + NUM_DEPENDENTS + TELEPHONE + FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - MALE_MAR_or_WID 1 478 524 #&gt; - RADIO_TV 1 478 524 #&gt; - TELEPHONE 1 479 525 #&gt; - AGE 1 479 525 #&gt; &lt;none&gt; 478 526 #&gt; - REAL_ESTATE 1 480 526 #&gt; - EDUCATION 1 480 526 #&gt; - CO_APPLICANT 1 480 526 #&gt; - OWN_RES 1 480 526 #&gt; - NUM_DEPENDENTS 1 480 526 #&gt; - EMPLOYMENT 1 480 526 #&gt; - FOREIGN 1 480 526 #&gt; - GUARANTOR 1 481 527 #&gt; - DURATION 1 482 528 #&gt; - NEW_CAR 1 482 528 #&gt; - NUM_CREDITS 1 482 528 #&gt; - USED_CAR 1 483 529 #&gt; - AMOUNT 1 483 529 #&gt; - OTHER_INSTALL 1 483 529 #&gt; - SAV_ACCT 1 484 530 #&gt; - MALE_SINGLE 1 484 530 #&gt; - INSTALL_RATE 1 488 534 #&gt; - HISTORY 1 489 535 #&gt; - CHK_ACCT 1 517 563 #&gt; #&gt; Step: AIC=524 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + RADIO_TV + EDUCATION + AMOUNT + SAV_ACCT + EMPLOYMENT + #&gt; INSTALL_RATE + MALE_SINGLE + CO_APPLICANT + GUARANTOR + REAL_ESTATE + #&gt; AGE + OTHER_INSTALL + OWN_RES + NUM_CREDITS + NUM_DEPENDENTS + #&gt; TELEPHONE + FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - RADIO_TV 1 479 523 #&gt; - TELEPHONE 1 479 523 #&gt; - AGE 1 479 523 #&gt; &lt;none&gt; 478 524 #&gt; - CO_APPLICANT 1 480 524 #&gt; - EDUCATION 1 480 524 #&gt; - OWN_RES 1 480 524 #&gt; - REAL_ESTATE 1 480 524 #&gt; - NUM_DEPENDENTS 1 480 524 #&gt; - EMPLOYMENT 1 480 524 #&gt; - FOREIGN 1 481 525 #&gt; - GUARANTOR 1 481 525 #&gt; - DURATION 1 482 526 #&gt; - NEW_CAR 1 482 526 #&gt; - NUM_CREDITS 1 482 526 #&gt; - USED_CAR 1 483 527 #&gt; - AMOUNT 1 483 527 #&gt; - OTHER_INSTALL 1 484 528 #&gt; - SAV_ACCT 1 484 528 #&gt; - MALE_SINGLE 1 484 528 #&gt; - INSTALL_RATE 1 488 532 #&gt; - HISTORY 1 490 534 #&gt; - CHK_ACCT 1 517 561 #&gt; #&gt; Step: AIC=523 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + EDUCATION + AMOUNT + SAV_ACCT + EMPLOYMENT + INSTALL_RATE + #&gt; MALE_SINGLE + CO_APPLICANT + GUARANTOR + REAL_ESTATE + AGE + #&gt; OTHER_INSTALL + OWN_RES + NUM_CREDITS + NUM_DEPENDENTS + #&gt; TELEPHONE + FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - TELEPHONE 1 479 521 #&gt; - AGE 1 480 522 #&gt; - EDUCATION 1 480 522 #&gt; &lt;none&gt; 479 523 #&gt; - OWN_RES 1 481 523 #&gt; - CO_APPLICANT 1 481 523 #&gt; - REAL_ESTATE 1 481 523 #&gt; - NUM_DEPENDENTS 1 481 523 #&gt; - EMPLOYMENT 1 481 523 #&gt; - FOREIGN 1 481 523 #&gt; - GUARANTOR 1 481 523 #&gt; - NEW_CAR 1 482 524 #&gt; - DURATION 1 483 525 #&gt; - NUM_CREDITS 1 483 525 #&gt; - AMOUNT 1 483 525 #&gt; - OTHER_INSTALL 1 484 526 #&gt; - SAV_ACCT 1 484 526 #&gt; - USED_CAR 1 484 526 #&gt; - MALE_SINGLE 1 485 527 #&gt; - INSTALL_RATE 1 488 530 #&gt; - HISTORY 1 490 532 #&gt; - CHK_ACCT 1 517 559 #&gt; #&gt; Step: AIC=521 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + EDUCATION + AMOUNT + SAV_ACCT + EMPLOYMENT + INSTALL_RATE + #&gt; MALE_SINGLE + CO_APPLICANT + GUARANTOR + REAL_ESTATE + AGE + #&gt; OTHER_INSTALL + OWN_RES + NUM_CREDITS + NUM_DEPENDENTS + #&gt; FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - AGE 1 481 521 #&gt; - EDUCATION 1 481 521 #&gt; &lt;none&gt; 479 521 #&gt; - REAL_ESTATE 1 481 521 #&gt; - OWN_RES 1 481 521 #&gt; - CO_APPLICANT 1 481 521 #&gt; - EMPLOYMENT 1 482 522 #&gt; - NUM_DEPENDENTS 1 482 522 #&gt; - FOREIGN 1 482 522 #&gt; - GUARANTOR 1 482 522 #&gt; - NEW_CAR 1 483 523 #&gt; - AMOUNT 1 483 523 #&gt; - NUM_CREDITS 1 483 523 #&gt; - DURATION 1 484 524 #&gt; - OTHER_INSTALL 1 484 524 #&gt; - SAV_ACCT 1 485 525 #&gt; - USED_CAR 1 485 525 #&gt; - MALE_SINGLE 1 485 525 #&gt; - INSTALL_RATE 1 489 529 #&gt; - HISTORY 1 491 531 #&gt; - CHK_ACCT 1 517 557 #&gt; #&gt; Step: AIC=521 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + EDUCATION + AMOUNT + SAV_ACCT + EMPLOYMENT + INSTALL_RATE + #&gt; MALE_SINGLE + CO_APPLICANT + GUARANTOR + REAL_ESTATE + OTHER_INSTALL + #&gt; OWN_RES + NUM_CREDITS + NUM_DEPENDENTS + FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; - EDUCATION 1 483 521 #&gt; - OWN_RES 1 483 521 #&gt; - REAL_ESTATE 1 483 521 #&gt; &lt;none&gt; 481 521 #&gt; - NUM_DEPENDENTS 1 483 521 #&gt; - CO_APPLICANT 1 483 521 #&gt; - FOREIGN 1 483 521 #&gt; - GUARANTOR 1 484 522 #&gt; - NEW_CAR 1 484 522 #&gt; - EMPLOYMENT 1 484 522 #&gt; - NUM_CREDITS 1 485 523 #&gt; - AMOUNT 1 485 523 #&gt; - OTHER_INSTALL 1 486 524 #&gt; - DURATION 1 486 524 #&gt; - USED_CAR 1 487 525 #&gt; - SAV_ACCT 1 487 525 #&gt; - MALE_SINGLE 1 488 526 #&gt; - INSTALL_RATE 1 491 529 #&gt; - HISTORY 1 493 531 #&gt; - CHK_ACCT 1 519 557 #&gt; #&gt; Step: AIC=521 #&gt; as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + NEW_CAR + #&gt; USED_CAR + AMOUNT + SAV_ACCT + EMPLOYMENT + INSTALL_RATE + #&gt; MALE_SINGLE + CO_APPLICANT + GUARANTOR + REAL_ESTATE + OTHER_INSTALL + #&gt; OWN_RES + NUM_CREDITS + NUM_DEPENDENTS + FOREIGN #&gt; #&gt; Df Deviance AIC #&gt; &lt;none&gt; 483 521 #&gt; - CO_APPLICANT 1 485 521 #&gt; - NUM_DEPENDENTS 1 485 521 #&gt; - REAL_ESTATE 1 485 521 #&gt; - OWN_RES 1 485 521 #&gt; - NEW_CAR 1 485 521 #&gt; - FOREIGN 1 485 521 #&gt; - GUARANTOR 1 486 522 #&gt; - EMPLOYMENT 1 486 522 #&gt; - NUM_CREDITS 1 486 522 #&gt; - AMOUNT 1 487 523 #&gt; - DURATION 1 487 523 #&gt; - OTHER_INSTALL 1 488 524 #&gt; - SAV_ACCT 1 489 525 #&gt; - USED_CAR 1 489 525 #&gt; - MALE_SINGLE 1 489 525 #&gt; - INSTALL_RATE 1 493 529 #&gt; - HISTORY 1 494 530 #&gt; - CHK_ACCT 1 521 557 #&gt; #&gt; Call: #&gt; glm(formula = as_factor(RESPONSE) ~ CHK_ACCT + DURATION + HISTORY + #&gt; NEW_CAR + USED_CAR + AMOUNT + SAV_ACCT + EMPLOYMENT + INSTALL_RATE + #&gt; MALE_SINGLE + CO_APPLICANT + GUARANTOR + REAL_ESTATE + OTHER_INSTALL + #&gt; OWN_RES + NUM_CREDITS + NUM_DEPENDENTS + FOREIGN, family = &quot;binomial&quot;, #&gt; data = GermanCredit.tr.subs) #&gt; #&gt; Deviance Residuals: #&gt; Min 1Q Median 3Q Max #&gt; -2.3291 -0.7941 -0.0223 0.8436 2.7271 #&gt; #&gt; Coefficients: #&gt; Estimate Std. Error z value Pr(&gt;|z|) #&gt; (Intercept) 0.278774 0.688865 0.40 0.6857 #&gt; CHK_ACCT 0.586161 0.098355 5.96 2.5e-09 *** #&gt; DURATION -0.026793 0.012312 -2.18 0.0295 * #&gt; HISTORY 0.396195 0.120761 3.28 0.0010 ** #&gt; NEW_CAR -0.418013 0.266963 -1.57 0.1174 #&gt; USED_CAR 1.274349 0.506059 2.52 0.0118 * #&gt; AMOUNT -0.000118 0.000060 -1.97 0.0489 * #&gt; SAV_ACCT 0.192047 0.077843 2.47 0.0136 * #&gt; EMPLOYMENT 0.189099 0.102915 1.84 0.0661 . #&gt; INSTALL_RATE -0.371760 0.116127 -3.20 0.0014 ** #&gt; MALE_SINGLE 0.648522 0.249422 2.60 0.0093 ** #&gt; CO_APPLICANT -0.820815 0.588238 -1.40 0.1629 #&gt; GUARANTOR 0.876033 0.523354 1.67 0.0942 . #&gt; REAL_ESTATE 0.398212 0.264990 1.50 0.1329 #&gt; OTHER_INSTALL -0.650676 0.286898 -2.27 0.0233 * #&gt; OWN_RES 0.391979 0.251667 1.56 0.1193 #&gt; NUM_CREDITS -0.415974 0.221120 -1.88 0.0599 . #&gt; NUM_DEPENDENTS -0.505290 0.339192 -1.49 0.1363 #&gt; FOREIGN 1.105547 0.726194 1.52 0.1279 #&gt; --- #&gt; Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 #&gt; #&gt; (Dispersion parameter for binomial family taken to be 1) #&gt; #&gt; Null deviance: 654.33 on 471 degrees of freedom #&gt; Residual deviance: 482.61 on 453 degrees of freedom #&gt; AIC: 520.6 #&gt; #&gt; Number of Fisher Scoring iterations: 5 Predictions: #&gt; Obs #&gt; Pred 0 1 #&gt; 0 46 36 #&gt; 1 18 100 Not a good model. Do not forget that the prior of this data set is not balanced at all. We should take it into account. As depicted below, if our model was good, we should have boxplot that are far away from the 0.5, which is not the case, especially for the bad credits. 3.3.1 Cross-validation #&gt; Generalized Linear Model with Stepwise Feature Selection #&gt; #&gt; 472 samples #&gt; 30 predictor #&gt; 2 classes: &#39;0&#39;, &#39;1&#39; #&gt; #&gt; No pre-processing #&gt; Resampling: Cross-Validated (10 fold) #&gt; Summary of sample sizes: 425, 425, 425, 425, 424, 424, ... #&gt; Resampling results: #&gt; #&gt; Accuracy Kappa #&gt; 0.703 0.407 #&gt; Cross-Validated (10 fold) Confusion Matrix #&gt; #&gt; (entries are percentual average cell counts across resamples) #&gt; #&gt; Reference #&gt; Prediction 0 1 #&gt; 0 35.6 15.3 #&gt; 1 14.4 34.7 #&gt; #&gt; Accuracy (average) : 0.7034 3.4 Trees #&gt; Obs #&gt; Pred 0 1 #&gt; 0 42 48 #&gt; 1 22 88 #&gt; 0 1 #&gt; 1 0.257 0.743 #&gt; 2 0.683 0.317 #&gt; 3 0.683 0.317 #&gt; 4 0.343 0.657 #&gt; 5 0.683 0.317 #&gt; 6 0.683 0.317 #&gt; 7 0.257 0.743 #&gt; 8 0.257 0.743 #&gt; 9 0.683 0.317 #&gt; 10 0.683 0.317 #&gt; 11 0.257 0.743 #&gt; 12 0.257 0.743 #&gt; 13 0.683 0.317 #&gt; 14 0.683 0.317 #&gt; 15 0.257 0.743 #&gt; 16 0.683 0.317 #&gt; 17 0.683 0.317 #&gt; 18 0.683 0.317 #&gt; 19 0.257 0.743 #&gt; 20 0.343 0.657 #&gt; 21 0.683 0.317 #&gt; 22 0.683 0.317 #&gt; 23 0.683 0.317 #&gt; 24 0.257 0.743 #&gt; 25 0.257 0.743 #&gt; 26 0.257 0.743 #&gt; 27 0.683 0.317 #&gt; 28 0.257 0.743 #&gt; 29 0.683 0.317 #&gt; 30 0.683 0.317 #&gt; 31 0.257 0.743 #&gt; 32 0.257 0.743 #&gt; 33 0.683 0.317 #&gt; 34 0.257 0.743 #&gt; 35 0.257 0.743 #&gt; 36 0.343 0.657 #&gt; 37 0.683 0.317 #&gt; 38 0.257 0.743 #&gt; 39 0.343 0.657 #&gt; 40 0.257 0.743 #&gt; 41 0.683 0.317 #&gt; 42 0.683 0.317 #&gt; 43 0.257 0.743 #&gt; 44 0.683 0.317 #&gt; 45 0.257 0.743 #&gt; 46 0.257 0.743 #&gt; 47 0.257 0.743 #&gt; 48 0.343 0.657 #&gt; 49 0.683 0.317 #&gt; 50 0.257 0.743 #&gt; 51 0.257 0.743 #&gt; 52 0.683 0.317 #&gt; 53 0.257 0.743 #&gt; 54 0.257 0.743 #&gt; 55 0.257 0.743 #&gt; 56 0.257 0.743 #&gt; 57 0.683 0.317 #&gt; 58 0.683 0.317 #&gt; 59 0.257 0.743 #&gt; 60 0.257 0.743 #&gt; 61 0.683 0.317 #&gt; 62 0.257 0.743 #&gt; 63 0.257 0.743 #&gt; 64 0.257 0.743 #&gt; 65 0.683 0.317 #&gt; 66 0.683 0.317 #&gt; 67 0.683 0.317 #&gt; 68 0.683 0.317 #&gt; 69 0.683 0.317 #&gt; 70 0.683 0.317 #&gt; 71 0.257 0.743 #&gt; 72 0.257 0.743 #&gt; 73 0.683 0.317 #&gt; 74 0.683 0.317 #&gt; 75 0.257 0.743 #&gt; 76 0.343 0.657 #&gt; 77 0.257 0.743 #&gt; 78 0.683 0.317 #&gt; 79 0.257 0.743 #&gt; 80 0.683 0.317 #&gt; 81 0.257 0.743 #&gt; 82 0.257 0.743 #&gt; 83 0.683 0.317 #&gt; 84 0.683 0.317 #&gt; 85 0.683 0.317 #&gt; 86 0.683 0.317 #&gt; 87 0.343 0.657 #&gt; 88 0.683 0.317 #&gt; 89 0.257 0.743 #&gt; 90 0.683 0.317 #&gt; 91 0.257 0.743 #&gt; 92 0.257 0.743 #&gt; 93 0.257 0.743 #&gt; 94 0.257 0.743 #&gt; 95 0.683 0.317 #&gt; 96 0.257 0.743 #&gt; 97 0.683 0.317 #&gt; 98 0.257 0.743 #&gt; 99 0.343 0.657 #&gt; 100 0.257 0.743 #&gt; 101 0.257 0.743 #&gt; 102 0.343 0.657 #&gt; 103 0.257 0.743 #&gt; 104 0.343 0.657 #&gt; 105 0.257 0.743 #&gt; 106 0.683 0.317 #&gt; 107 0.257 0.743 #&gt; 108 0.343 0.657 #&gt; 109 0.683 0.317 #&gt; 110 0.257 0.743 #&gt; 111 0.683 0.317 #&gt; 112 0.257 0.743 #&gt; 113 0.343 0.657 #&gt; 114 0.683 0.317 #&gt; 115 0.257 0.743 #&gt; 116 0.683 0.317 #&gt; 117 0.683 0.317 #&gt; 118 0.257 0.743 #&gt; 119 0.343 0.657 #&gt; 120 0.683 0.317 #&gt; 121 0.683 0.317 #&gt; 122 0.683 0.317 #&gt; 123 0.343 0.657 #&gt; 124 0.343 0.657 #&gt; 125 0.257 0.743 #&gt; 126 0.683 0.317 #&gt; 127 0.683 0.317 #&gt; 128 0.683 0.317 #&gt; 129 0.343 0.657 #&gt; 130 0.257 0.743 #&gt; 131 0.257 0.743 #&gt; 132 0.257 0.743 #&gt; 133 0.257 0.743 #&gt; 134 0.683 0.317 #&gt; 135 0.683 0.317 #&gt; 136 0.257 0.743 #&gt; 137 0.257 0.743 #&gt; 138 0.257 0.743 #&gt; 139 0.683 0.317 #&gt; 140 0.257 0.743 #&gt; 141 0.257 0.743 #&gt; 142 0.257 0.743 #&gt; 143 0.257 0.743 #&gt; 144 0.257 0.743 #&gt; 145 0.257 0.743 #&gt; 146 0.683 0.317 #&gt; 147 0.683 0.317 #&gt; 148 0.683 0.317 #&gt; 149 0.257 0.743 #&gt; 150 0.683 0.317 #&gt; 151 0.257 0.743 #&gt; 152 0.683 0.317 #&gt; 153 0.257 0.743 #&gt; 154 0.257 0.743 #&gt; 155 0.683 0.317 #&gt; 156 0.683 0.317 #&gt; 157 0.683 0.317 #&gt; 158 0.343 0.657 #&gt; 159 0.683 0.317 #&gt; 160 0.683 0.317 #&gt; 161 0.683 0.317 #&gt; 162 0.683 0.317 #&gt; 163 0.683 0.317 #&gt; 164 0.257 0.743 #&gt; 165 0.683 0.317 #&gt; 166 0.257 0.743 #&gt; 167 0.257 0.743 #&gt; 168 0.683 0.317 #&gt; 169 0.257 0.743 #&gt; 170 0.683 0.317 #&gt; 171 0.683 0.317 #&gt; 172 0.257 0.743 #&gt; 173 0.343 0.657 #&gt; 174 0.257 0.743 #&gt; 175 0.257 0.743 #&gt; 176 0.683 0.317 #&gt; 177 0.257 0.743 #&gt; 178 0.257 0.743 #&gt; 179 0.257 0.743 #&gt; 180 0.683 0.317 #&gt; 181 0.683 0.317 #&gt; 182 0.683 0.317 #&gt; 183 0.683 0.317 #&gt; 184 0.343 0.657 #&gt; 185 0.343 0.657 #&gt; 186 0.683 0.317 #&gt; 187 0.257 0.743 #&gt; 188 0.257 0.743 #&gt; 189 0.683 0.317 #&gt; 190 0.683 0.317 #&gt; 191 0.683 0.317 #&gt; 192 0.257 0.743 #&gt; 193 0.683 0.317 #&gt; 194 0.257 0.743 #&gt; 195 0.257 0.743 #&gt; 196 0.257 0.743 #&gt; 197 0.683 0.317 #&gt; 198 0.683 0.317 #&gt; 199 0.257 0.743 #&gt; 200 0.683 0.317 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
