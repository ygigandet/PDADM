---
title: "eda"
author: "Yooby"
date: "4/19/2022"
output: html_document
---

```{r setup, include=FALSE}
source(here::here("script/setup.R"))
```

```{r, eval=FALSE, include=FALSE}
setwd(here::here("data/"))
GermanCredit <- read_csv("GermanCreditClean.csv")
```

## Exploratory Data Analysis

```{r}
# First, let's look at the distribution of the responses of credits
GermanCredit %>% 
  ggplot(aes(x = RESPONSE)) +
  geom_bar() +
  labs(title = "Number of 'good' vs 'bad' credits",
       y = "Number of credit applications",
       x = "Rate of the credits: 0 = bad, 1 = good") +
  theme_light()

# Interesting to see that our data is biased. We have more than 2/3 good credit applications and 1/3 of bad credit applications.
```

```{r, eval=FALSE}
# Distribution of the numerical columns, i.e. duration, amount, install_rate, age, num_credits, num_dependence

p.duration <- GermanCredit %>% 
  ggplot(aes(x = DURATION)) +
  geom_histogram(binwidth = 1) +
  labs(title = "Duration of the credit applications",
       y = "Number of credit applications",
       x = "Duration in months")

p.duration

# Not a lot to say about the duration of the credits. It varies a lot.

p.amount <- GermanCredit %>% 
  ggplot(aes(x = AMOUNT)) +
  geom_histogram(binwidth = 100) +
  labs(title = "Amount of the credit applications",
       y = "Number of credit applications",
       x = "Amount in DM")

p.amount

# Relatively small amount, less than 5'000

p.install_rate <- GermanCredit %>% 
  ggplot(aes(x = INSTALL_RATE)) +
  geom_histogram(binwidth = 1) +
  labs(title = "Installment rate as % of disposable income",
       y = "Number of credit applications",
       x = "%")

p.install_rate

# Installment rate (in other words, repayment rate) is more around 4%

p.age <- GermanCredit %>% 
  ggplot(aes(x = AGE)) +
  geom_histogram(binwidth = 1) +
  labs(title = "Age of the credit applicants",
       y = "Number of credit applications",
       x = "Age in years")

p.age

# It is skewed, the younger, the better 

p.num_credits <- GermanCredit %>% 
  ggplot(aes(x = NUM_CREDITS)) +
  geom_histogram(binwidth = 1) +
  labs(title = "Number of existing credits at this bank",
       y = "Number of credit applications",
       x = "Number")

p.num_credits

# The less the better, 1 to 3

p.num_dependents <- GermanCredit %>% 
  ggplot(aes(x = NUM_DEPENDENTS)) +
  geom_histogram(binwidth = 1) +
  labs(title = "Number of people for whom liable to provide maintenance",
       y = "Number of credit applications",
       x = "People")

p.num_dependents

# Mostly one dependent
```

```{r}
# Link between the amount for the credit and the credit history of the applicant
# 0 means no credits taken, 1: all credits at this bank paid back duly, 
# 2: existing credits paid back duly till now, 3: delay in paying off in the past
# 4: critical account

p.amount_history <- GermanCredit %>% 
  ggplot(aes(x = AMOUNT, fill = HISTORY)) +
  geom_histogram(binwidth = 1000)

p.amount_history

# It's not surprising, when credits are paid, the more they give.

p.amount_chk_account <- GermanCredit %>% 
  ggplot(aes(x = AMOUNT, fill = CHK_ACCT)) +
  geom_histogram(binwidth = 1000)

p.amount_chk_account
```

```{r}
# let's check if old people have basically more credit than young people
mean_yes <- mean(YES_GC$AGE)
mean_yes

mean_no <- mean(NO_GC$AGE)
mean_no

# age does not seem to be a key criterion 
```

```{r}
# what about the amount of savings
# ggplot(YES_GC, aes(x=dose, y=len)) + 
#   geom_boxplot(notch=TRUE)
# boxplot(YES_GC$SAV_ACCT)

```

```{r}
# comparison of the credit amount asked 

comp_credits <- boxplot(NO_GC$AMOUNT, YES_GC$AMOUNT,
        horizontal=TRUE,
        names=c("Refused", "Accepted"),
        col=c("light grey","dark grey"),
        xlab="Credit amount",
        main="Comparison of the credit amount asked by the person")

comp_credits # refused person asked for a bigger amount (a bit obvious).


```

```{r}
# correlation matrix

#head(YES_GC)
# corgc <- cor(GermanCredit)
# corgc

```


