
```{r setup, include=FALSE}
source(here::here("script/setup.R"))
```


```{r}
setwd(here::here("data/"))
GermanCredit <- read_csv("GermanCreditClean.csv")
```

# Decision Tree

```{r}
set.seed(123) # for reproducibility
index.tr <- sample(x=1:nrow(GermanCredit), size=2/3*nrow(GermanCredit), replace=FALSE)
GermanCredit.tr <- GermanCredit[index.tr,]
GermanCredit.te <- GermanCredit[-index.tr,]
```

```{r}
# Initialise our tree
GermanCreditTree <- rpart(as_factor(RESPONSE)~., data=GermanCredit.tr)
rpart.plot(GermanCreditTree)
```

```{r}
plotcp(GermanCreditTree)
```

```{r}
GermanCreditTree.prune <- prune(GermanCreditTree, cp=0.035)
rpart.plot(GermanCreditTree.prune)
```

```{r}
pred <- predict(GermanCreditTree.prune, newdata=GermanCredit.te, type="class")
table(Pred=pred, Obs=GermanCredit.te$RESPONSE)

predict(GermanCreditTree.prune, newdata=GermanCredit.te, type="prob")
```

